<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>MQTT 基本概念  &middot; garfcat</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="mqtt, ">


<meta property="og:title" content="MQTT 基本概念  &middot; garfcat ">
<meta property="og:site_name" content="garfcat"/>
<meta property="og:url" content="http://www.geekgame.site/2019/05/15/mqtt-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2019-05-15T13:24:24&#43;08:00" />
<meta property="og:article:modified_time" content="2019-05-15T13:24:24&#43;08:00" />

  
    
<meta property="og:article:tag" content="mqtt">
    
  

  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "MQTT 基本概念",
    "author": {
      "@type": "Person",
      "name": "yourname"
    },
    "datePublished": "2019-05-15",
    "description": "",
    "wordCount":  92 
  }
</script>



<link rel="canonical" href="http://www.geekgame.site/2019/05/15/mqtt-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.geekgame.site/touch-icon-144-precomposed.png">
<link href="http://www.geekgame.site/favicon.png" rel="icon">

<meta name="generator" content="Hugo 0.75.0" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/css/font-awesome.min.css">
<link rel="stylesheet" href="/css/style.css">
<link rel="stylesheet" href="/css/highlight/default.css">

  
  
</head>
<body>
  <main id="main-wrapper" class="container main_wrapper has-sidebar">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="http://www.geekgame.site">
  foobar

</a>

</div>

  
<div class="container topline">
  
  few words about your site


</div>


</div>

  <nav class="container nav primary no-print">
  

<a class="homelink" href="http://www.geekgame.site">home</a>


  

</nav>

<div class="container nav secondary no-print">
  
<a id="contact-link-email" class="contact_link" rel="me" aria-label="Email" href="mailto:yourname@example.com">
  <span class="fa fa-envelope-square"></span></a>



<a id="contact-link-github" class="contact_link" rel="me" aria-label="Github" href="https://github.com/enten/hugo-boilerplate">
  <span class="fa fa-github-square"></span></a>




 


















</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>MQTT 基本概念
</h1>

  <div class="metas">
<time datetime="2019-05-15">15 May, 2019</time>


  
  &middot; Read in about 1 min
  &middot; (92 Words)
  <br>
  
<a class="label" href="http://www.geekgame.site/tags/mqtt">mqtt</a>



</div>

</header>

  <div class="container content">
  <p>MQTT(Message Queuing Telemetry Transport，消息队列遥测传输协议)是最初由IBM开发的一种基于发布/订阅模式的轻量级通信协议,工作在tcp/ip协议簇上。主要优势是
低开销、低带宽，在lot上应用较为广泛。</p>
<h1 id="mqtt-架构">MQTT 架构</h1>
<ol>
<li>MQTT 是c/s模型，每个客户端通过tcp连接到服务器(broker)；</li>
<li>MQTT 是面向消息的。每个消息都是独立的数据块，对于broker来说是不透明的；</li>
<li>每条消息都会发送到一个地址，这个地址称为主题(topic),订阅主题的每个客户端都会收到发布到该主题上的每条消息；</li>
</ol>
<p>如下所示： 客户端 A、B、C都连接到一个中间broker; <br>
B、C都订阅topic :dev_info 来获取其他设备的设备信息；<br>
A发布设备信息到topic dev_info，broker 将该消息转发给所有的订阅者即 BC；<br>
<img src="https://raw.githubusercontent.com/garfcat/garfcat/master/static/mqtt_arch.png" alt="mqqtt_arch"></p>
<h1 id="主题匹配">主题匹配</h1>
<p>mqtt 主题是分层级的，通过／划分层级。如 A/B/G ;
注意在订阅时可以使用通配符，发布时不可以使用通配符；<br>
通配符 + 匹配任何单个主题，# 匹配任意名称任意数量的主题；<br>
例如： A/+/G 可以匹配 A/B/G A/C/G A/D/G 等<br>
A/# 可以配置 A/B/C/D/E/F/G</p>
<h1 id="qos">Qos</h1>
<p>mqtt 支持三种级别的服务质量:<br>
0: &ldquo;至多一次&rdquo; 并不需要回复确认消息，有可能丢失消息；<br>
1: &ldquo;至少一次&rdquo; 收到报文后会回复确认消息，这样会重复收到消息（如超时回复确认消息情况）；<br>
2: &ldquo;只有一次&rdquo; 通过 publish pubrec pubrel pubcomp 四个状态确认有且只有一次消息被处理，但是网络带宽会增加；</p>
<h1 id="最后遗愿last-will">最后遗愿(last will)</h1>
<p>提前预定好的消息，当客户端断开连接时，broker 会将该消息发送给所有订阅者的客户端；</p>
<h1 id="持久retain">持久(retain)</h1>
<p>topic 设置retain 之后，broker 会保留最后一条retain消息,当client 订阅该topic 时会立刻收到一条retain消息；</p>
<h1 id="清理会话cleansession">清理会话（cleansession）</h1>
<p>设置为true时，客户端建立连接时将清除旧的连接，即再次连接时不会收到消息；<br>
设置为false时，客户端即使断开连接，再次连接时会收到未接收的消息；</p>
<h1 id="安全">安全</h1>
<p>可以通过ssl/tls 双向认证保证数据安全， 也可以通过 单向 ssl/tls + 单向https/username/password 保证双向安全；</p>
<h1 id="参考">参考</h1>
<ol>
<li><a href="https://zh.wikipedia.org/wiki/MQTT">维基百科 MQTT</a></li>
<li><a href="https://mosquitto.org/man/mqtt-7.html">MQTT manpage</a></li>
<li><a href="https://www.eclipse.org/community/eclipse_newsletter/2014/february/article2.php">MQTT and CoAP, IoT Protocols</a></li>
</ol>
</div>


  <footer class="container">
  <div class="container navigation no-print">
  <h2>Navigation</h2>
  
  

    
    <a class="prev" href="http://www.geekgame.site/2019/05/13/mac-sed-%E6%8A%A5%E9%94%99/" title="mac  sed 报错">
      Previous
    </a>
    

    
    <a class="next" href="http://www.geekgame.site/2019/05/16/%E9%AB%98%E6%95%88shell/" title="高效shell">
      Next
    </a>
    

  


</div>

  
<div class="container comments">
  <h2>Comments</h2>
  
<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//your_disqus_shortname.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>


</footer>

</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  

  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  
  code with <!-- raw HTML omitted --><!-- raw HTML omitted -->


</div>


  
<div class="container copyright">
  
  (c) 2021 garfcat.


</div>


</div>

</footer>

    </main>
    
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;
    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//your_disqus_shortname.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



    
  </body>
</html>

